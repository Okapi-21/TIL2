## モデルのバリデーションとリレーション

#### バリデーション

　バリデーションとは、ユーザーからの入力データが要件や仕様に適合しているのかを確認するプロセスのこと。ソフトウェアにおいて、ユーザーからの入力は正しい形式や範囲内である必要があるが、バリデーションを設けることによって、不正確なデータや予期しないデータがシステムに入力されることを防ぐことができる。

#### バリデーションヘルパー

### 主なバリデーションルール一覧（Laravel）

| ルール名    | 用途・説明                                       | 例（バリデーション記法）                                 | 備考・代表的な用途                 |
| ----------- | ------------------------------------------------ | -------------------------------------------------------- | ---------------------------------- |
| required    | 入力が必須。空欄の場合はエラー。                 | `'username' => 'required'`                               | ユーザー名・メールなど必須項目     |
| confirmed   | 入力値が確認用フィールドと一致しているか。       | `'password' => 'required|confirmed'`                     | パスワード再入力確認など           |
| regex       | 正規表現で形式をチェック。                       | `'email' => 'required|regex:/^[\w\.-]+@[\w\.-]+\.\w+$/'` | メール・電話番号等フォーマット確認 |
| min / max   | 文字数や数値の最小/最大値を制限。                | `'username' => 'required|min:3|max:20'`                  | ユーザー名・パスワード等の長さ制限 |
| integer     | 整数のみ許可。数値以外はエラー。                 | `'age' => 'required|integer'`                            | 年齢・数量・価格等                 |
| unique      | データベースで一意かどうかを確認。重複はエラー。 | `'email' => 'required|email|unique:users,email'`         | メール・ユーザーID等の重複防止     |
| sometimes   | リクエストに値がある場合のみバリデーション。     | `'discount' => 'sometimes|integer'`                      | オプション項目など                 |
| required_if | 条件付き必須。指定条件に合致した場合のみ必須。   | `'age' => 'required_if:role,admin|integer'`              | 管理者のみ必須項目等               |

---

### 初学者向け補足

- **required** … 必須項目。未入力の場合は必ずエラーになります。
- **confirmed** … 例えば「password」と「password_confirmation」が両方一致しているかを自動でチェックします。
- **regex** … 入力値が、指定したパターン（形式）に合っているか確認できます。複雑な入力ルールも作れます。
- **min / max** … ユーザー名やパスワードなど、長すぎ・短すぎを防ぐために使います。
- **unique** … 例えば同じメールアドレスで複数登録されないようにできます。
- **sometimes, required_if** … 入力値や状況によってバリデーションの必要が変わる場合に便利です。

> バリデーションは、ユーザーからの入力値を安全かつ正しく扱うための仕組みです。<br>
> 適切に設定することで、不正なデータや重複データを防ぐことができます。

---
### さらに学びたい方へ

- [Laravel公式バリデーションドキュメント](https://laravel.com/docs/validation)

